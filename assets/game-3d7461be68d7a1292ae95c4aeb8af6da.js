var GAME={};GAME.assets={subtitle:"/assets/subtitle-b68a4e7e45262e28312a775b96c439f0.png",fullStack:"/assets/full-stack-text-f413ce6d52927c5c4e42319bbb23163f.png",stackTech:"/assets/stack-tech-22a9c1f37afb7ecb61919c965c8e4def.png",clickDrag:"/assets/drag-595a152f8b5280efc33dceb68231ab96.png",player:"/assets/player-5c4473a01aae961a8af049c1e6a35fbb.png",cursor:"/assets/cursor-ee559f9d1109c63a3fe88dec79c0bd27.png"},GAME.Boot=function(){},GAME.Boot.prototype={preload:function(){},create:function(){this.game.scale.scaleMode=Phaser.ScaleManager.NO_SCALE,this.game.state.start("preloader")}},GAME.Main=function(){this.stackY=470},GAME.Main.prototype={create:function(){this.game.physics.startSystem(Phaser.Physics.P2JS),this.game.physics.p2.gravity.y=300,this.bgHelpers=this.game.add.group(),this.subtitle=new GAME.Subtitle(this.game,this.game.world.centerX,this.stackY+65),this.drawClickDrag(),this.drawBoxStack(),this.wireSpawn(),this.cursors=this.game.input.keyboard.createCursorKeys()},update:function(){this.subtitle.update(),this.stack.update(),this.player&&this.player.update(this.cursors)},drawBoxStack:function(){this.stack=new GAME.BoxStack(this.game,this.game.world.centerX-130,this.stackY,80,80,4,this.stackText)},drawClickDrag:function(){this.drag=this.bgHelpers.create(this.game.world.centerX-285,215,"clickDrag"),this.drag.scale={x:.37,y:.37}},wireSpawn:function(){$(".spawner").click(function(){$("body").animate({scrollTop:0},"fast"),this.player||(this.drag.kill(),this.cursor=this.bgHelpers.create(this.game.world.centerX+30,230,"cursor"),this.player=new GAME.Player(this.game,this.game.world.centerX,400),this.stack.explode())}.bind(this))},stackText:[[{text:"HTML"}],[{text:"CSS"},{text:"Sass"}],[{text:"Java-\nScript"},{text:"Back-\nbone"},{text:" jQuery "}],[{text:"Ruby"},{text:"Rails"},{text:"SQL"},{text:"Mongo"}]]},GAME.Preloader=function(){},GAME.Preloader.prototype={preload:function(){this.game.load.image("subtitle",GAME.assets.subtitle),this.game.load.image("fullStack",GAME.assets.fullStack),this.game.load.image("stackTech",GAME.assets.stackTech),this.game.load.image("clickDrag",GAME.assets.clickDrag),this.game.load.image("cursor",GAME.assets.cursor),this.game.load.spritesheet("player",GAME.assets.player,64,64)},create:function(){var t=this;WebFont.load({google:{families:["Indie Flower"]},active:function(){t.game.state.start("main")}})}},GAME.Box=function(t,i,s,e,a,r){this.game=t,this.x=i,this.y=s,this.sizeX=e,this.sizeY=a,this.text=r,this.init()},GAME.Box.prototype={init:function(){var t=this.game.add.bitmapData(this.sizeX,this.sizeY);t.ctx.fillStyle="#eeeeee",t.ctx.fillRect(0,0,this.sizeX,this.sizeY),t.ctx.lineWidth=5,t.ctx.strokeStyle="#222222",t.ctx.strokeRect(0,0,this.sizeX,this.sizeY),this.sprite=this.game.add.sprite(this.x,this.y,t),this.game.physics.p2.enable(this.sprite),this.sprite.body.collideWithWorldBounds=!0,this.sprite.inputEnabled=!0,this.sprite.alpha=1,this.draggable(),this.drawText()},drawText:function(){this.textSprite=this.game.add.text(0,0,this.text,{font:'20px "Indie Flower"'}),this.textSprite.lineSpacing=2,this.textSprite.anchor.set(.5),this.sprite.addChild(this.textSprite)},draggable:function(){this.sprite.input.enableDrag()},killable:function(){this.sprite.events.onInputDown.add(function(){this.sprite.kill()},this)},update:function(){this.sprite.input.isDragged&&(this.sprite.body.x=this.game.input.activePointer.worldX,this.sprite.body.y=this.game.input.activePointer.worldY,this.sprite.body.setZeroVelocity())}},GAME.BoxStack=function(t,i,s,e,a,r,h){this.game=t,this.x=i,this.y=s,this.sizeX=e,this.sizeY=a,this.rows=r,this.spacing=6,this.boxes=[],this.textMap=h,this.init()},GAME.BoxStack.prototype={init:function(){this.drawStack(this.rows,this.x,this.y)},drawStack:function(t,i,s){for(var e=i,a=0;t>a;a++)this.boxes.push(new GAME.Box(this.game,e,s,this.sizeX,this.sizeY,this.textMap[t-1][a].text)),e+=this.sizeX+this.spacing;t-1>0&&this.drawStack(t-1,i+(this.sizeX+this.spacing)/2,s-this.sizeY)},explode:function(){for(var t=0;t<this.boxes.length;t++){var i=this.boxes[t].sprite.body;i.velocity.x=1e4*(1/(-1*(this.game.world.centerX-i.x))),i.velocity.y=1e3}},update:function(){for(var t=0;t<this.boxes.length;t++)this.boxes[t].update()}},GAME.Player=function(t,i,s){this.game=t,this.x=i,this.y=s,this.inAir=!1,this.init()},GAME.Player.prototype={init:function(){this.sprite=this.game.add.sprite(this.x,this.y,"player"),this.game.physics.p2.enable(this.sprite),this.sprite.body.fixedRotation=!0,this.sprite.animations.add("run",[11,12,13,14,15],10,!0),this.sprite.animations.add("jump",[0,1,2,3,4,5,6,7,8,9,10],10,!1)},update:function(t){var i=this.jumping();t.left.isDown?(this.sprite.body.moveLeft(150),this.sprite.scale.x=1,i||this.sprite.animations.play("run")):t.right.isDown?(this.sprite.body.moveRight(150),this.sprite.scale.x=-1,i||this.sprite.animations.play("run")):(this.sprite.body.velocity.x=0,i||(this.sprite.animations.stop(),this.sprite.frame=16)),t.up.isDown&&!i&&(this.sprite.body.moveUp(240),this.sprite.animations.play("jump"))},jumping:function(){for(var t=p2.vec2.fromValues(0,1),i=!1,s=0;s<this.game.physics.p2.world.narrowphase.contactEquations.length;s++){var e=this.game.physics.p2.world.narrowphase.contactEquations[s];if(e.bodyA===this.sprite.body.data||e.bodyB===this.sprite.body.data){var a=p2.vec2.dot(e.normalA,t);e.bodyA===this.sprite.body.data&&(a*=-1),a>.5&&(i=!0)}}return!i}},GAME.Subtitle=function(t,i,s){this.game=t,this.x=i,this.y=s,this.init()},GAME.Subtitle.prototype={init:function(){this.sprite=this.game.add.sprite(this.x,this.y,"fullStack"),this.game.physics.p2.enable(this.sprite),this.sprite.body["static"]=!0},update:function(){this.sprite.input&&this.sprite.input.isDragged&&(this.sprite.body.x=this.game.input.activePointer.worldX,this.sprite.body.y=this.game.input.activePointer.worldY,this.sprite.body.setZeroVelocity(),this.sprite.body.setZeroRotation())}},$(function(){var t=$("#game-container"),i=new Phaser.Game(t.width(),t.height(),Phaser.AUTO,"game-container",null,!0);i.state.add("boot",GAME.Boot),i.state.add("preloader",GAME.Preloader),i.state.add("main",GAME.Main),i.state.start("boot")});